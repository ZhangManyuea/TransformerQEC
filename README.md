# TransformerQEC

> Implementation of [Transformer-QEC: Quantum Error Correction Code Decoding with Transferable Transformers](https://arxiv.org/abs/2311.16082)

## Requirements

```bash
pip install numpy polars tqdm pyyaml ray torch positional-encodings[pytorch]
```

## Overview

 - **Quantum Data Generation**: The Python script (`data_gen.py`) generates synthetic data for quantum error correction experiments. It leverages the stim_experiments module for quantum circuit simulation and various utility functions for encoding, decoding, and data processing.

 - **Data Preparation**:The `data.py` is a Python script designed to prepare input and output tensors for quantum error correction experiments. It includes functions for decoding and preprocessing data from a CSV file generated by a quantum error correction circuit.

- **Configurations**: `config.yaml` specifies parameters such as the distance, number of shots, dataset-directory and number-of-encoding-channels.

- **Tranformer Model**: `transformer_model.model.py`
    - This file contains implementations of various components for building Transformer models.
    - `MultiSelfAttention` is a module that implements multi-head self-attention for Transformer models.
    - `TransformerBlock` is a module representing a single block within the Transformer architecture.
    - `Transformer` is the main model for sequence-to-classif tasks using the Transformer architecture.

## Configuration

`config.yaml`: to specify parameters such as the distance, number of shots, dataset-directory and number-of-encoding-channels. Here's an example of a configuration file:

```yaml
# data
DISTANCE: 5
SHOTS: 2000
DATASET_DIR: "datasets"
ENCODING_CHANNEL: 6
```

## Usage

After setting the configuration file, execute the following command for data generation:

```python
python data_gen.py
```
This will generate synthetic data for quantum error correction experiments, including syndromes and errors. The data will be stored in CSV files in the specified dataset directory.

## Additional Notes

- The number of parallel executions is set to half of the available CPU cores for efficiency.
- The `get_n_shots` function generates and stores data for multiple shots of a quantum error correction circuit in parallel, leveraging Ray for parallelism.